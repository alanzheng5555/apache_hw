# Apache_HW Utils 模块使用指南

## 项目结构
```
design/utils/
├── rtl/                    # RTL源代码目录
│   ├── clock_buffer.v      # 时钟缓冲器
│   ├── clock_divider.v     # 时钟分频器
│   ├── clock_mux.v         # 时钟多路选择器
│   ├── clock_switch.v      # 时钟切换器
│   ├── clock_gating.v      # 时钟门控单元
│   ├── sync_cell.v         # 同步器
│   └── edge_detector.v     # 边沿检测器
├── sim/                    # 仿真目录
│   ├── tb_*.v              # 对应的测试台文件
│   └── Makefile            # 仿真管理文件
└── readme.md               # 需求说明文件
```

## 快速开始

### 1. 编译所有测试台
```bash
cd ~/clawd/project/apache_hw/design/utils/sim
make all
```

### 2. 运行特定模块仿真
```bash
# 运行时钟分频器仿真
make simulate_clock_divider

# 运行边沿检测器仿真
make simulate_edge_detector

# 运行时钟门控仿真
make simulate_clock_gating
```

### 3. 运行所有仿真
```bash
make simulate_all
```

### 4. 查看波形（需要安装GTKWave）
```bash
gtkwave tb_clock_divider.vcd
```

## Makefile 命令详解

- `make all` - 编译所有测试台
- `make simulate_<module>` - 运行特定模块仿真
  - 支持的模块: clock_buffer, clock_divider, clock_mux, clock_switch, clock_gating, sync_cell, edge_detector
- `make simulate_all` - 运行所有模块仿真
- `make clean` - 删除编译文件和波形文件
- `make clean_waves` - 仅删除波形文件
- `make help` - 显示帮助信息

## 模块功能说明

1. **Clock Buffer**: 简单的时钟缓冲器，输入直接传递到输出
2. **Clock Divider**: 可配置分频系数的时钟分频器
3. **Clock Mux**: 多路时钟选择器，根据选择信号选择时钟源
4. **Clock Switch**: 双时钟切换器，在主备时钟间切换
5. **Clock Gating**: 时钟门控单元，通过使能信号控制时钟输出
6. **Sync Cell**: 两级同步器，用于跨时钟域信号同步
7. **Edge Detector**: 边沿检测器，检测正边沿、负边沿和任意边沿

## 验证状态
所有模块均已通过功能仿真验证，输出波形符合预期行为。