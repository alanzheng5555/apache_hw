#! /usr/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/system.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_sys.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_textio.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/v2005_math.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/va_math.vpi";
S_0x6298ba3ff120 .scope module, "simple_pe_test" "simple_pe_test" 2 4;
 .timescale -9 -12;
L_0x6298ba459f70 .functor BUFZ 1, v0x6298ba459a30_0, C4<0>, C4<0>, C4<0>;
v0x6298ba42e110_0 .net *"_ivl_1", 3 0, L_0x6298ba459c90;  1 drivers
L_0x769ba9e8f018 .functor BUFT 1, C4<0010>, C4<0>, C4<0>, C4<0>;
v0x6298ba4591a0_0 .net/2u *"_ivl_2", 3 0, L_0x769ba9e8f018;  1 drivers
v0x6298ba459280_0 .net *"_ivl_4", 0 0, L_0x6298ba459d60;  1 drivers
v0x6298ba459320_0 .var "clk", 0 0;
v0x6298ba4593e0_0 .var "data_a", 15 0;
v0x6298ba459510_0 .var "data_b", 15 0;
v0x6298ba4595f0_0 .var "instruction", 31 0;
v0x6298ba4596d0_0 .var "mac_result", 15 0;
v0x6298ba4597b0_0 .var "relu_result", 15 0;
v0x6298ba459890_0 .net "result", 15 0, L_0x6298ba459e80;  1 drivers
v0x6298ba459970_0 .var "rst_n", 0 0;
v0x6298ba459a30_0 .var "valid_in", 0 0;
v0x6298ba459af0_0 .net "valid_out", 0 0, L_0x6298ba459f70;  1 drivers
v0x6298ba459bb0_0 .var "weight", 15 0;
E_0x6298ba4389a0 .event posedge, v0x6298ba459320_0;
L_0x6298ba459c90 .part v0x6298ba4595f0_0, 28, 4;
L_0x6298ba459d60 .cmp/eq 4, L_0x6298ba459c90, L_0x769ba9e8f018;
L_0x6298ba459e80 .functor MUXZ 16, v0x6298ba4596d0_0, v0x6298ba4597b0_0, L_0x6298ba459d60, C4<>;
    .scope S_0x6298ba3ff120;
T_0 ;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x6298ba459320_0, 0, 1;
T_0.0 ;
    %delay 5000, 0;
    %load/vec4 v0x6298ba459320_0;
    %inv;
    %store/vec4 v0x6298ba459320_0, 0, 1;
    %jmp T_0.0;
    %end;
    .thread T_0;
    .scope S_0x6298ba3ff120;
T_1 ;
    %wait E_0x6298ba4389a0;
    %load/vec4 v0x6298ba459970_0;
    %nor/r;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.0, 8;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v0x6298ba4596d0_0, 0;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v0x6298ba4597b0_0, 0;
    %jmp T_1.1;
T_1.0 ;
    %load/vec4 v0x6298ba459a30_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.2, 8;
    %load/vec4 v0x6298ba4595f0_0;
    %parti/s 4, 28, 6;
    %cmpi/e 1, 0, 4;
    %jmp/0xz  T_1.4, 4;
    %load/vec4 v0x6298ba4593e0_0;
    %load/vec4 v0x6298ba459bb0_0;
    %mul;
    %load/vec4 v0x6298ba459510_0;
    %add;
    %assign/vec4 v0x6298ba4596d0_0, 0;
    %jmp T_1.5;
T_1.4 ;
    %load/vec4 v0x6298ba4595f0_0;
    %parti/s 4, 28, 6;
    %cmpi/e 2, 0, 4;
    %jmp/0xz  T_1.6, 4;
    %load/vec4 v0x6298ba4596d0_0;
    %pad/s 32;
    %cmpi/s 0, 0, 32;
    %flag_or 5, 4; GT is !LE
    %flag_inv 5;
    %jmp/0xz  T_1.8, 5;
    %load/vec4 v0x6298ba4596d0_0;
    %assign/vec4 v0x6298ba4597b0_0, 0;
    %jmp T_1.9;
T_1.8 ;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v0x6298ba4597b0_0, 0;
T_1.9 ;
T_1.6 ;
T_1.5 ;
T_1.2 ;
T_1.1 ;
    %jmp T_1;
    .thread T_1;
    .scope S_0x6298ba3ff120;
T_2 ;
    %vpi_call 2 50 "$display", "Starting Simple PE Core Test..." {0 0 0};
    %vpi_call 2 51 "$monitor", "Time: %0t, Data_A: 0x%h, Weight: 0x%h, Data_B: 0x%h, Result: 0x%h", $time, v0x6298ba4593e0_0, v0x6298ba459bb0_0, v0x6298ba459510_0, v0x6298ba459890_0 {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x6298ba459970_0, 0, 1;
    %pushi/vec4 2, 0, 16;
    %store/vec4 v0x6298ba4593e0_0, 0, 16;
    %pushi/vec4 1, 0, 16;
    %store/vec4 v0x6298ba459510_0, 0, 16;
    %pushi/vec4 3, 0, 16;
    %store/vec4 v0x6298ba459bb0_0, 0, 16;
    %pushi/vec4 268435456, 0, 32;
    %store/vec4 v0x6298ba4595f0_0, 0, 32;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %delay 20000, 0;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x6298ba459970_0, 0, 1;
    %delay 10000, 0;
    %vpi_call 2 67 "$display", "\012--- MAC Test (2 * 3 + 1) ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %pushi/vec4 268435456, 0, 32;
    %store/vec4 v0x6298ba4595f0_0, 0, 32;
    %delay 20000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %load/vec4 v0x6298ba459890_0;
    %vpi_call 2 72 "$display", "Expected: 7, Got: %d", S<0,vec4,s16> {1 0 0};
    %delay 20000, 0;
    %vpi_call 2 77 "$display", "\012--- ReLU Test (Positive Value) ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %pushi/vec4 536870913, 0, 32;
    %store/vec4 v0x6298ba4595f0_0, 0, 32;
    %delay 20000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %load/vec4 v0x6298ba459890_0;
    %vpi_call 2 82 "$display", "ReLU of positive value: %d", S<0,vec4,s16> {1 0 0};
    %delay 20000, 0;
    %vpi_call 2 87 "$display", "\012--- ReLU Test (Negative Value) ---" {0 0 0};
    %pushi/vec4 45056, 0, 16;
    %store/vec4 v0x6298ba4593e0_0, 0, 16;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %pushi/vec4 536870913, 0, 32;
    %store/vec4 v0x6298ba4595f0_0, 0, 32;
    %delay 20000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x6298ba459a30_0, 0, 1;
    %load/vec4 v0x6298ba459890_0;
    %vpi_call 2 93 "$display", "ReLU of negative value: %d", S<0,vec4,s16> {1 0 0};
    %vpi_call 2 95 "$display", "\012Simple PE Core Test Completed Successfully!" {0 0 0};
    %vpi_call 2 96 "$display", "Demonstrated:" {0 0 0};
    %vpi_call 2 97 "$display", "- MAC operation (multiply-accumulate)" {0 0 0};
    %vpi_call 2 98 "$display", "- ReLU activation function" {0 0 0};
    %vpi_call 2 99 "$display", "- Basic instruction decoding" {0 0 0};
    %vpi_call 2 100 "$finish" {0 0 0};
    %end;
    .thread T_2;
# The file index is used to find the file name in the following table.
:file_names 3;
    "N/A";
    "<interactive>";
    "simple_pe_test.v";
